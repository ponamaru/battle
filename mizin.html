<html>
<head>
    <style>
.typing-animation::after {
  content: '';
  border-right: 1px solid #333;
  margin-left: 2px;
  animation: flashing 1s linear infinite;
  opacity: 0;
}

@keyframes flashing {
  0%, 100% {
    opacity: 0;
  }
  50% {
    opacity: 1;
  }
}

#area {
display: block;
	  color: #FFF;
	position: absolute;
	top: 0;
	left: 0;
    font-size: 30;
    background-color:rgba(0,0,0,0.5);

}
#select {
	  color: white;
	position: absolute;
	top: 0;
	left: 0;
    font-size: 30;
    background-color:rgba(0,0,0,0.5);
}
#select2 {
	  color: #FFF;
	position: absolute;
	top: 0;
	left: 0;
    font-size: 30;
    background-color:rgba(0,0,0,0.5);
}
#square {
        background-color:rgba(0,0,255,0.5);
    width: 200px;
    height: 200px;
    	position: absolute;
    top: 70;
	left: 10;
}
#square2 {
    background-color:rgba(255,0,0,0.5);
    width: 200px;
    height: 200px;
    	position: absolute;
    top: 70;
	left: 10;
}
html, body {
    overflow: hidden;
}
 #triangle {
     width: 0;
         	position: absolute;
    top: 70;
	left: 10;
     height: 0;
     border-top: 20px solid transparent;
     border-right: 40px solid lightblue;
     transform: scale(-1, 1);
     border-bottom: 20px solid transparent;
 }

    </style>
</head>
<div id="square"></div>
<div id="square2"></div>
<div id="triangle"></div>
<div id="select">たたかう</div><div id="select2">にげる</div>
<div id="area" class="typing-animation"></div>

<script>
var hp = 200;
var damage = random2;
var nowtext = 0;
var random = Math.floor( Math.random() * 31 ) + 30;
var random2 = Math.floor( Math.random() * 21 ) + 20;
var UI = 1;
var array = ['スライムが現れた', 'どうする？', 'あなたはこうげきした。','スライムに' + random2 + 'ダメージ','スライムのこうげき',
'あなたに' + random2 + 'ダメージ'];
var selections = 0;
var decide = 1;
type();
document.getElementById( 'triangle' ).style.display = 'none'; 
document.getElementById( 'select' ).style.display = 'none'; 
document.getElementById( 'select2' ).style.display = 'none'; 
document.getElementById( 'select2' ).style.top = 600; 
document.getElementById( 'select2' ).style.left = 750; 
document.getElementById( 'area' ).style.top = 600;
document.getElementById( 'area' ).style.left = 550;
document.getElementById( 'select' ).style.top = 600; 
document.getElementById( 'select' ).style.left = 550; 
document.getElementById( 'triangle' ).style.top = 600; 
document.getElementById( 'triangle' ).style.left = 500; 
document.getElementById( 'area' ).style.display = 'block';
document.getElementById( 'square' ).style.width = 200 + "px";
    
addEventListener( "keydown", a );  
addEventListener( "keydown", b ); 
    
    function a () {
        	var key_code = event.keyCode;
  const conds = document.getElementById("area").innerText;
const textLS = conds.includes(array[nowtext]);
const textLS2 = conds.includes('スライムのこうげき');
  const seIn = document.getElementById("select").innerText;
const sei2 = seIn.includes('たたかう');
const sei1 = seIn.includes('こうげき');
const areaC = document.getElementById( 'area' );

const areadisplay = areaC.style.display === 'block';
if( key_code === 90 ) {
if (textLS2 === true){
const sq = document.getElementById( 'square2' );
hp = hp - random2;
sq.style.width = hp;
sq.style.height = hp;
}
if (textLS === true){
if(document.getElementById( 'area' ).style.display === 'block'){
nowtext = nowtext + 1;
document.getElementById("area").innerText = null;
type();
}
if(nowtext === 1){
selections = 2;
document.getElementById( 'area' ).style.top = 500;
document.getElementById( 'select' ).style.display = 'block'; 
document.getElementById( 'select2' ).style.display = 'block'; 
document.getElementById( 'triangle' ).style.display = 'block'; 

}
if(nowtext === 2) {
if(decide === 1) {
if(sei2 === true) {
document.getElementById("select").innerText = 'こうげき';
document.getElementById("select2").innerText = 'アイテム';
document.getElementById( 'area' ).style.display = 'none'; 
}
if(sei1 === true) {
document.getElementById( 'area' ).style.display = 'block'; 
document.getElementById( 'area' ).style.top = 600;
document.getElementById( 'select' ).style.display = 'none'; 
document.getElementById( 'select2' ).style.display = 'none'; 
selections = 0;
document.getElementById( 'triangle' ).style.display = 'none';
}
}
if(decide === 2) {
document.getElementById( 'select' ).style.display = 'none'; 
document.getElementById( 'select2' ).style.display = 'none'; 
document.getElementById( 'area' ).style.display = 'none'; 
}
 }  
}
}
}

function b() {
var key_code = event.keyCode;
if(key_code === 65) {
const sq = document.getElementById( 'square' );
sq.style.width = hp;
document.getElementById( 'square' ).style.height -= '50px';
}
if(key_code === 39) {
if(selections === 2) {
decide = 2;
document.getElementById( 'triangle' ).style.left = 700; 
}
}
if(key_code === 37) {
if(selections === 2) {
decide = 1;
document.getElementById( 'triangle' ).style.left = 500; 
}
}
}

function type () {
const typing = (el, sentence) => {
　　 
    [...sentence].forEach((char, index) => {
　　　
      setTimeout(() => {
        document.querySelector(el).textContent += char;
      }, 25 * ++index);
    });
 }

//関数を呼び出す
typing('.typing-animation', array[nowtext]);
    }
document.getElementById( 'area' ).style.top = 600;
document.getElementById( 'area' ).style.left = 550;
</script>
</html>
